---
import Layout from '../layouts/Layout.astro';
import MentionCard from '../components/MentionCard.astro';
import { recentMentions, bookMentions } from '../data/mentions';

// Calculate real stats
const totalMentions = bookMentions.length;
const uniqueBooks = new Set(bookMentions.map(m => `${m.book.title}-${m.book.author}`)).size;
const notableWriters = new Set(bookMentions.map(m => m.source.name)).size;

// Structured data for homepage
const structuredData = {
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "BookTrails",
  "description": "Discover books through authentic mentions from writers, thinkers, and creators you trust. Follow the trails of recommendations from podcasters, writers, and thought leaders.",
  "url": "https://booktrails.rabbitholes.garden",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "https://booktrails.rabbitholes.garden/search?q={search_term_string}",
    "query-input": "required name=search_term_string"
  },
  "publisher": {
    "@type": "Organization",
    "name": "BookTrails",
    "url": "https://booktrails.rabbitholes.garden"
  }
};
---

<Layout title="BookTrails - Books Worth Reading">
  <!-- Hero Section -->
  <section class="py-12 sm:py-16 md:py-24">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 text-center">
      <div class="relative">
        <div class="absolute inset-0 -top-8 bg-gradient-radial from-orange-200/20 to-transparent dark:from-orange-900/10 rounded-full blur-3xl"></div>
        <div class="relative">
          <h1 class="text-4xl md:text-5xl font-light text-stone-900 dark:text-stone-100 mb-6 tracking-tight leading-tight">
            Books worth reading, mentioned by 
            <span class="text-orange-500 font-normal">people worth listening to</span>
          </h1>
          <p class="text-lg md:text-xl text-stone-600 dark:text-stone-400 font-light max-w-2xl mx-auto mb-8 leading-relaxed">
            Most book sites only show you the good stuff. I track everything‚Äîthe books people love, the ones they hate, and the ones that make them lose their minds.
          </p>
          
          <!-- Search Bar -->
          <div class="max-w-md mx-auto mb-12">
            <form id="homepage-search-form" class="relative">
              <input 
                id="homepage-search-input"
                type="text" 
                placeholder="Search books, authors, or mentioners..."
                class="w-full px-6 py-4 text-base border border-stone-200 dark:border-stone-700 rounded-xl bg-white/80 dark:bg-stone-800/80 backdrop-blur-sm text-stone-900 dark:text-stone-100 placeholder-stone-500 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all"
              >
              <button type="submit" class="absolute right-4 top-1/2 -translate-y-1/2 text-stone-400 hover:text-orange-500 transition-colors">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                </svg>
              </button>
            </form>
          </div>
          
          <!-- Stats -->
          <div class="flex flex-wrap justify-center gap-8 text-sm text-stone-600 dark:text-stone-400">
            <div class="text-center">
              <div class="text-2xl font-light text-orange-500 dark:text-orange-400 mb-1">{totalMentions}</div>
              <div>Book mentions</div>
            </div>
            <div class="text-center">
              <div class="text-2xl font-light text-orange-500 dark:text-orange-400 mb-1">{notableWriters}</div>
              <div>Notable writers</div>
            </div>
            <div class="text-center">
              <div class="text-2xl font-light text-orange-500 dark:text-orange-400 mb-1">{uniqueBooks}</div>
              <div>Unique books</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Recent Mentions Feed -->
  <section class="py-12 sm:py-16">
    <div class="max-w-3xl mx-auto px-4 sm:px-6">
      <div class="flex items-center justify-between mb-12">
        <h2 class="text-2xl font-light text-stone-900 dark:text-stone-100 tracking-tight">
          Recent Mentions
        </h2>
        <a 
          href="/archive" 
          class="text-sm font-medium text-orange-600 dark:text-orange-400 hover:text-orange-700 dark:hover:text-orange-300 transition-colors"
        >
          View all ‚Üí
        </a>
      </div>
      
      <!-- Single Column Feed -->
      <div class="space-y-8">
        {recentMentions.slice(0, 6).map((mention) => (
          <MentionCard mention={mention} />
        ))}
      </div>
      
      <!-- Load More -->
      <div class="text-center mt-12">
        <a 
          href="/archive"
          class="inline-flex items-center gap-2 px-6 py-3 bg-orange-500 hover:bg-orange-600 text-white font-medium rounded-xl transition-colors"
        >
          Browse Archive
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
          </svg>
        </a>
      </div>
    </div>
  </section>

  <!-- Quick Access -->
  <section class="py-12 sm:py-16 bg-stone-50/50 dark:bg-stone-900/50">
    <div class="max-w-4xl mx-auto px-4 sm:px-6">
      <h2 class="text-2xl font-light text-stone-900 dark:text-stone-100 mb-8 text-center">
        Explore More
      </h2>
      
      <div class="grid md:grid-cols-3 gap-6">
        <a href="/archive" class="group bg-white dark:bg-stone-800 border border-stone-200 dark:border-stone-700 rounded-xl p-6 hover:shadow-lg transition-all">
          <h3 class="font-medium text-stone-900 dark:text-stone-100 group-hover:text-orange-600 dark:group-hover:text-orange-400 transition-colors mb-2">
            üìö Full Archive
          </h3>
          <p class="text-sm text-stone-600 dark:text-stone-400 mb-3">
            Browse all book mentions by date, topic, and sentiment
          </p>
          <span class="text-xs text-orange-600 dark:text-orange-400 font-medium">
            View all ‚Üí
          </span>
        </a>
        
        <a href="/books" class="group bg-white dark:bg-stone-800 border border-stone-200 dark:border-stone-700 rounded-xl p-6 hover:shadow-lg transition-all">
          <h3 class="font-medium text-stone-900 dark:text-stone-100 group-hover:text-orange-600 dark:group-hover:text-orange-400 transition-colors mb-2">
            üìñ Books Index
          </h3>
          <p class="text-sm text-stone-600 dark:text-stone-400 mb-3">
            Discover books by title, author, and publication year
          </p>
          <span class="text-xs text-orange-600 dark:text-orange-400 font-medium">
            Browse books ‚Üí
          </span>
        </a>
        
        <a href="/authors" class="group bg-white dark:bg-stone-800 border border-stone-200 dark:border-stone-700 rounded-xl p-6 hover:shadow-lg transition-all">
          <h3 class="font-medium text-stone-900 dark:text-stone-100 group-hover:text-orange-600 dark:group-hover:text-orange-400 transition-colors mb-2">
            ‚úçÔ∏è Notable People
          </h3>
          <p class="text-sm text-stone-600 dark:text-stone-400 mb-3">
            Explore mentions by podcasters, writers, and thinkers
          </p>
          <span class="text-xs text-orange-600 dark:text-orange-400 font-medium">
            See people ‚Üí
          </span>
        </a>
      </div>
    </div>
  </section>
</Layout>

<script>
  const homepageSearchForm = document.getElementById('homepage-search-form');
  const homepageSearchInput = document.getElementById('homepage-search-input');
  
  homepageSearchForm?.addEventListener('submit', (e) => {
    e.preventDefault();
    const query = homepageSearchInput?.value.trim();
    if (query) {
      window.location.href = `/search?q=${encodeURIComponent(query)}`;
    }
  });
</script>

<script type="application/ld+json" set:html={JSON.stringify(structuredData)}></script>
